?text-rendering
??background-repeat
# Load example data
p <- read.csv("https://stats.idre.ucla.edu/stat/data/poisson_sim.csv")
p <- within(p, {
prog <- factor(prog, levels=1:3, labels=c("General", "Academic", "Vocational"))
id <- factor(id)
})
# Fit Poisson regression
model <- glm(num_awards ~ math + prog, family = poisson, data = p)
# Calculate Pearson residuals
pearson_resid <- residuals(model, type = "pearson")
# Plot math score vs. Pearson residuals
plot(p$math, pearson_resid,
xlab = "Math Score",
ylab = "Standardized (Pearson) Residuals",
main = "Poisson Regression Diagnostics")
abline(h = 0, col = "red", lty = 2)
set.seed(123)
# Simulate Poisson data (mean = 5)
poisson_counts <- rpois(100, lambda = 5)
# Simulate overdispersed data (Negative Binomial, mean = 5, size = 1)
overdispersed_counts <- rnbinom(100, size = 1, mu = 5)
# Compare variance and mean
cat("Poisson: mean =", mean(poisson_counts), ", variance =", var(poisson_counts), "\n")
cat("Overdispersed: mean =", mean(overdispersed_counts), ", variance =", var(overdispersed_counts), "\n")
# Plot
boxplot(poisson_counts, overdispersed_counts,
names = c("Poisson", "Overdispersed"),
ylab = "Count",
main = "Poisson vs Overdispersed Counts")
# Simulate data with a trend not captured by a simple Poisson model
set.seed(42)
month <- 1:24
# True mean increases with month, but we fit a model without this trend
lambda <- 2 + 0.2 * month  # mean increases over time
counts <- rpois(length(month), lambda)
# Fit a Poisson model that ignores the trend (intercept only)
model <- glm(counts ~ 1, family = poisson)
resid_pearson <- residuals(model, type = "pearson")
# Plot residuals vs. month
plot(month, resid_pearson, pch = 19, xlab = "Month", ylab = "Pearson Residuals",
main = "Residuals vs. Month: Model Misspecification")
abline(h = 0, col = "red", lty = 2)
